<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Door Check-in</title>
  <style>
    *{ box-sizing:border-box; }

    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin:0;
      background:#f6f6f6;
      padding:16px;
    }

    .wrap{
      max-width:720px;
      margin:28px auto;
    }

    .card{
      background:#fff;
      border-radius:18px;
      padding:18px;
      box-shadow:0 10px 24px rgba(0,0,0,.08);
    }

    .top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }

    h2{
      margin:0;
      font-size:22px;
      font-weight:800;
      letter-spacing:.2px;
    }

    .subhead{
      margin-top:6px;
      color:#6b7280;
      font-size:13px;
      line-height:1.4;
    }

    .pill{
      padding:8px 12px;
      border-radius:999px;
      font-size:12px;
      font-weight:700;
      background:#eef2ff;
      color:#1e40af;
      white-space:nowrap;
      align-self:flex-start;
    }

    input{
      width:100%;
      font-size:20px;
      padding:14px 14px;
      border-radius:14px;
      border:1px solid #d1d5db;
      outline:none;
    }
    input:focus{
      border-color:#1976d2;
      box-shadow:0 0 0 4px rgba(25,118,210,.12);
    }

    button{
      margin-top:12px;
      width:100%;
      padding:14px;
      font-size:18px;
      border:0;
      border-radius:14px;
      background:#1976d2;
      color:#fff;
      font-weight:800;
      cursor:pointer;
    }
    button:active{ transform: translateY(1px); }

    .status{
      margin-top:14px;
      padding:22px 18px;
      border-radius:16px;
      font-size:26px;
      font-weight:900;
      letter-spacing:.6px;
      text-align:center;
      display:none;
      color:#fff;
      user-select:none;
    }
    .green{ background:#1faa59; }
    .red{ background:#e53935; }
    .black{ background:#111; }

    .details{
      margin-top:10px;
      padding:12px 14px;
      border:1px solid #eee;
      border-radius:14px;
      display:none;
      color:#111827;
      background:#fafafa;
    }
    .details .label{
      color:#6b7280;
      font-size:12px;
      font-weight:700;
      margin-bottom:4px;
      text-transform:uppercase;
      letter-spacing:.4px;
    }
    .details .name{
      font-size:16px;
      font-weight:800;
      margin-bottom:6px;
    }
    .details .meta{
      font-size:13px;
      color:#374151;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .muted{
      margin-top:10px;
      color:#9ca3af;
      font-size:12px;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <div>
          <h2>Door Check-in</h2>
          <div class="subhead">Enter <b>Badge</b> or <b>Phone</b> number, then press Check (or Enter).</div>
        </div>
        <div class="pill" id="doorPill">Operator: Door-1</div>
      </div>

      <input id="inp" placeholder="Enter Badge or Phone" inputmode="numeric" autocomplete="off" autofocus />
      <button id="btn">Check</button>

      <div id="st" class="status"></div>

      <div id="details" class="details">
        <div class="label">Matched Attendee</div>
        <div class="name" id="personName">â€”</div>
        <div class="meta">
          <div><b>Badge:</b> <span id="personBadge">â€”</span></div>
          <div><b>Phone:</b> <span id="personPhone">â€”</span></div>
        </div>
      </div>

      <div class="muted">Tip: Use different links per device: <code>?door=Door-2</code>, <code>?door=Door-3</code> â€¦</div>
    </div>
  </div>

  <script>
    // ðŸ”´ PUT YOUR GOOGLE APPS SCRIPT WEB APP URL HERE:
    const API_URL = "https://script.google.com/macros/s/AKfycbwg3lZaWUVGJGftGMXlrtWo0I2pm-ivZDadq9O8_qrWhX1qbC9rgFdItVhp4lTtcpBf/execE";

    // âœ… Operator comes from URL param so each door can have its own link:
    // Door 1: https://afmusalami.github.io/event-checkin/?door=Door-1
    // Door 2: https://afmusalami.github.io/event-checkin/?door=Door-2
    const OPERATOR = new URLSearchParams(window.location.search).get("door") || "Door-1";

    const inp = document.getElementById("inp");
    const btn = document.getElementById("btn");
    const st = document.getElementById("st");

    const doorPill = document.getElementById("doorPill");
    const detailsBox = document.getElementById("details");
    const personName = document.getElementById("personName");
    const personBadge = document.getElementById("personBadge");
    const personPhone = document.getElementById("personPhone");

    doorPill.textContent = "Operator: " + OPERATOR;

    function norm(v){
      return String(v || "").trim().replace(/\s+/g, "");
    }

    function maskPhone(p){
      const s = String(p || "").trim();
      if (!s) return "â€”";
      const last4 = s.replace(/\D/g, "").slice(-4);
      return last4 ? ("****" + last4) : "â€”";
    }

    function show(type, msg, data){
      st.className = "status " + type;
      st.style.display = "block";
      st.textContent = msg;

      // Show details only when we matched someone
      if (data && (data.name || data.badge || data.phone)){
        detailsBox.style.display = "block";
        personName.textContent = data.name || "â€”";
        personBadge.textContent = data.badge || "â€”";
        personPhone.textContent = maskPhone(data.phone);
      } else {
        detailsBox.style.display = "none";
        personName.textContent = "â€”";
        personBadge.textContent = "â€”";
        personPhone.textContent = "â€”";
      }
    }

    async function check(){
      const input = norm(inp.value);
      if(!input){
        show("black","ENTER VALUE");
        return;
      }

      try{
        const res = await fetch(API_URL, {
          method:"POST",
          headers: {"Content-Type":"text/plain;charset=utf-8"},
          body: JSON.stringify({ input, operator: OPERATOR })
        });

        const data = await res.json();

        if(data.status === "GREEN"){
          show("green","âœ… WELCOME", data);
        } else if(data.status === "RED"){
          show("red","âŒ DUPLICATED", data);
        } else {
          show("black","ðŸš« NOT IN LIST");
        }

      }catch(e){
        show("black","NETWORK / API ERROR");
      }finally{
        // Auto-clear & refocus for fast door flow
        setTimeout(() => {
          inp.value = "";
          inp.focus();
        }, 900);
      }
    }

    btn.addEventListener("click", check);
    inp.addEventListener("keydown", e => { if(e.key==="Enter") check(); });
  </script>
</body>
</html>
